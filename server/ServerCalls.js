/// <reference path="../both/TimeMachine.ts"/>
console.log("ServerCall.ts is loading");
Meteor.startup(function () {
    console.log("ServerCall.ts startup is running");
    if (Meteor.isServer) {
        Meteor.methods({
            getListForTarget: function (theObject) {
                var factoryObject = Factory.CreateProxyInstance(theObject.classType);
                //       factoryObject.getRelatedObject(theObject);
            },
            cleanDB: function () {
                var timeM = new TimeMachineClass();
                timeM.cleanDBServer();
            },
            createAssessmentDetails: function (scenario, domain) {
                AppLog.info("inside meteor methods calling createAssessmentDetail");
                // var theTree = AssessementClass.createAssessmentDetailsServer(scenario,domain)
                // return theTree;
            },
            removeObject: function (theObject) {
                var factoryObject = Factory.CreateProxyInstance(theObject.classType);
                factoryObject.removeServer(theObject);
            },
            removeMapReference: function (theObject) {
                var factoryObject = Factory.CreateProxyInstance(ClassType.MAP);
                factoryObject.removeReferenceServer(theObject.id1, theObject.id2);
            },
            capabilitySafeRemoval: function (treeNode) {
                var factoryObject = Factory.CreateProxyInstanceTree("capability");
                factoryObject.removeServer(treeNode);
            },
            capabilityRemoveSet: function (theList, domain) {
                var factoryObject = Factory.CreateProxyInstanceTree("capability");
                factoryObject.removeSet(theList);
            },
            dimensionSafeRemoval: function (treeNode) {
                var factoryObject = Factory.CreateProxyInstanceTree("dimension");
                factoryObject.removeServer(treeNode);
            },
            removeMap: function (id) {
                var mapObject = Factory.CreateProxyInstance(ClassType.MAP);
                mapObject.removeReferenceServer(id, null);
                ;
            },
            updateTechAssessment: function (theID, techValue) {
                try {
                }
                catch (e) {
                    AppLog.error("Error Updating Assessment", e);
                }
            },
            createTransitions: function (domain) {
                //TransitionClass.createTransitionsServer(domain);
            },
        });
        var Fiber = Npm.require('fibers');
        process.on('uncaughtException', function (err) {
            AppLog.error(err.message, err);
            Fiber(function () {
                //      Logs.insert({ ... }) // Logs is a collection
            }).run();
            process.exit(1);
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2VydmVyQ2FsbHMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJTZXJ2ZXJDYWxscy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSw4Q0FBOEM7QUFJOUMsT0FBTyxDQUFDLEdBQUcsQ0FBQywwQkFBMEIsQ0FBQyxDQUFDO0FBRXhDLE1BQU0sQ0FBQyxPQUFPLENBQUM7SUFDWCxPQUFPLENBQUMsR0FBRyxDQUFDLGtDQUFrQyxDQUFDLENBQUM7SUFFaEQsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUM7UUFFbEIsTUFBTSxDQUFDLE9BQU8sQ0FBQztZQUVYLGdCQUFnQixFQUFFLFVBQVUsU0FBYTtnQkFFckMsSUFBSSxhQUFhLEdBQVUsT0FBTyxDQUFDLG1CQUFtQixDQUFDLFNBQVMsQ0FBQyxTQUFTLENBQUMsQ0FBQztnQkFFNUUsbURBQW1EO1lBQ3ZELENBQUM7WUFFYyxPQUFPLEVBQUU7Z0JBQ0wsSUFBSSxLQUFLLEdBQUcsSUFBSSxnQkFBZ0IsRUFBRSxDQUFDO2dCQUVuQyxLQUFLLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDMUIsQ0FBQztZQUVELHVCQUF1QixFQUFFLFVBQVUsUUFBWSxFQUFFLE1BQVU7Z0JBQ3ZELE1BQU0sQ0FBQyxJQUFJLENBQUMsc0RBQXNELENBQUMsQ0FBQztnQkFDcEUsZ0ZBQWdGO2dCQUNoRixrQkFBa0I7WUFFdEIsQ0FBQztZQUVELFlBQVksRUFBRSxVQUFVLFNBQVM7Z0JBRTdCLElBQUksYUFBYSxHQUFHLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7Z0JBRXJFLGFBQWEsQ0FBQyxZQUFZLENBQUMsU0FBUyxDQUFDLENBQUM7WUFDMUMsQ0FBQztZQUVELGtCQUFrQixFQUFFLFVBQVUsU0FBUztnQkFFbkMsSUFBSSxhQUFhLEdBQVUsT0FBTyxDQUFDLG1CQUFtQixDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFFdEUsYUFBYSxDQUFDLHFCQUFxQixDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsU0FBUyxDQUFDLEdBQUcsQ0FBQyxDQUFDO1lBRXRFLENBQUM7WUFFRCxxQkFBcUIsRUFBRSxVQUFVLFFBQVE7Z0JBQ3JDLElBQUksYUFBYSxHQUFHLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxZQUFZLENBQUMsQ0FBQztnQkFFbEUsYUFBYSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUV6QyxDQUFDO1lBRUQsbUJBQW1CLEVBQUUsVUFBVSxPQUFPLEVBQUUsTUFBTTtnQkFFMUMsSUFBSSxhQUFhLEdBQUcsT0FBTyxDQUFDLHVCQUF1QixDQUFDLFlBQVksQ0FBQyxDQUFDO2dCQUVsRSxhQUFhLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBRXJDLENBQUM7WUFFRCxvQkFBb0IsRUFBRSxVQUFVLFFBQVE7Z0JBQ3BDLElBQUksYUFBYSxHQUFHLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxXQUFXLENBQUMsQ0FBQztnQkFFakUsYUFBYSxDQUFDLFlBQVksQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUN6QyxDQUFDO1lBRUQsU0FBUyxFQUFFLFVBQVUsRUFBRTtnQkFDbkIsSUFBSSxTQUFTLEdBQVUsT0FBTyxDQUFDLG1CQUFtQixDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFFbEUsU0FBUyxDQUFDLHFCQUFxQixDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztnQkFDMUMsQ0FBQztZQUNMLENBQUM7WUFFRCxvQkFBb0IsRUFBRSxVQUFVLEtBQUssRUFBRSxTQUFTO2dCQUU1QyxJQUFJLENBQUM7Z0JBTUwsQ0FBRTtnQkFBQSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUNULE1BQU0sQ0FBQyxLQUFLLENBQUMsMkJBQTJCLEVBQUUsQ0FBQyxDQUFDLENBQUM7Z0JBQ2pELENBQUM7WUFFTCxDQUFDO1lBRUQsaUJBQWlCLEVBQUUsVUFBVSxNQUFVO2dCQUVuQyxrREFBa0Q7WUFFdEQsQ0FBQztTQUlKLENBQUMsQ0FBQztRQUVsQixJQUFJLEtBQUssR0FBRyxHQUFHLENBQUMsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQ2xDLE9BQU8sQ0FBQyxFQUFFLENBQUMsbUJBQW1CLEVBQUUsVUFBVSxHQUFHO1lBQ3pDLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxHQUFHLENBQUMsQ0FBQztZQUMvQixLQUFLLENBQUM7Z0JBQ0Ysb0RBQW9EO1lBQ3hELENBQUMsQ0FBQyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ1QsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQTtRQUNuQixDQUFDLENBQUMsQ0FBQztJQUVQLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8vLyA8cmVmZXJlbmNlIHBhdGg9XCIuLi9ib3RoL1RpbWVNYWNoaW5lLnRzXCIvPlxuXG5kZWNsYXJlIHZhciBUYXNrRGVwZW5kZW5jeTpNb25nby5Db2xsZWN0aW9uPGFueT47XG5cbmNvbnNvbGUubG9nKFwiU2VydmVyQ2FsbC50cyBpcyBsb2FkaW5nXCIpO1xuXG5NZXRlb3Iuc3RhcnR1cChmdW5jdGlvbiAoKSB7XG4gICAgY29uc29sZS5sb2coXCJTZXJ2ZXJDYWxsLnRzIHN0YXJ0dXAgaXMgcnVubmluZ1wiKTtcblxuICAgIGlmIChNZXRlb3IuaXNTZXJ2ZXIpIHtcblxuICAgICAgICBNZXRlb3IubWV0aG9kcyh7XG5cbiAgICAgICAgICAgIGdldExpc3RGb3JUYXJnZXQ6IGZ1bmN0aW9uICh0aGVPYmplY3Q6YW55KSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgZmFjdG9yeU9iamVjdCA9IDxNYXBzPiBGYWN0b3J5LkNyZWF0ZVByb3h5SW5zdGFuY2UodGhlT2JqZWN0LmNsYXNzVHlwZSk7XG5cbiAgICAgICAgICAgICAgICAvLyAgICAgICBmYWN0b3J5T2JqZWN0LmdldFJlbGF0ZWRPYmplY3QodGhlT2JqZWN0KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFuREI6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGltZU0gPSBuZXcgVGltZU1hY2hpbmVDbGFzcygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZU0uY2xlYW5EQlNlcnZlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlQXNzZXNzbWVudERldGFpbHM6IGZ1bmN0aW9uIChzY2VuYXJpbzphbnksIGRvbWFpbjphbnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBcHBMb2cuaW5mbyhcImluc2lkZSBtZXRlb3IgbWV0aG9kcyBjYWxsaW5nIGNyZWF0ZUFzc2Vzc21lbnREZXRhaWxcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdmFyIHRoZVRyZWUgPSBBc3Nlc3NlbWVudENsYXNzLmNyZWF0ZUFzc2Vzc21lbnREZXRhaWxzU2VydmVyKHNjZW5hcmlvLGRvbWFpbilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyByZXR1cm4gdGhlVHJlZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3ZlT2JqZWN0OiBmdW5jdGlvbiAodGhlT2JqZWN0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmFjdG9yeU9iamVjdCA9IEZhY3RvcnkuQ3JlYXRlUHJveHlJbnN0YW5jZSh0aGVPYmplY3QuY2xhc3NUeXBlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnlPYmplY3QucmVtb3ZlU2VydmVyKHRoZU9iamVjdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdmVNYXBSZWZlcmVuY2U6IGZ1bmN0aW9uICh0aGVPYmplY3QpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWN0b3J5T2JqZWN0ID0gPE1hcHM+IEZhY3RvcnkuQ3JlYXRlUHJveHlJbnN0YW5jZShDbGFzc1R5cGUuTUFQKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnlPYmplY3QucmVtb3ZlUmVmZXJlbmNlU2VydmVyKHRoZU9iamVjdC5pZDEsIHRoZU9iamVjdC5pZDIpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBjYXBhYmlsaXR5U2FmZVJlbW92YWw6IGZ1bmN0aW9uICh0cmVlTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWN0b3J5T2JqZWN0ID0gRmFjdG9yeS5DcmVhdGVQcm94eUluc3RhbmNlVHJlZShcImNhcGFiaWxpdHlcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5T2JqZWN0LnJlbW92ZVNlcnZlcih0cmVlTm9kZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhcGFiaWxpdHlSZW1vdmVTZXQ6IGZ1bmN0aW9uICh0aGVMaXN0LCBkb21haW4pIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWN0b3J5T2JqZWN0ID0gRmFjdG9yeS5DcmVhdGVQcm94eUluc3RhbmNlVHJlZShcImNhcGFiaWxpdHlcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN0b3J5T2JqZWN0LnJlbW92ZVNldCh0aGVMaXN0KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgZGltZW5zaW9uU2FmZVJlbW92YWw6IGZ1bmN0aW9uICh0cmVlTm9kZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmYWN0b3J5T2JqZWN0ID0gRmFjdG9yeS5DcmVhdGVQcm94eUluc3RhbmNlVHJlZShcImRpbWVuc2lvblwiKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhY3RvcnlPYmplY3QucmVtb3ZlU2VydmVyKHRyZWVOb2RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbW92ZU1hcDogZnVuY3Rpb24gKGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1hcE9iamVjdCA9IDxNYXBzPiBGYWN0b3J5LkNyZWF0ZVByb3h5SW5zdGFuY2UoQ2xhc3NUeXBlLk1BUCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXBPYmplY3QucmVtb3ZlUmVmZXJlbmNlU2VydmVyKGlkLCBudWxsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVUZWNoQXNzZXNzbWVudDogZnVuY3Rpb24gKHRoZUlELCB0ZWNoVmFsdWUpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qICBBc3Nlc3NtZW50LnVwZGF0ZShcblx0XHRcdFx0XHRcdFx0XHRcdCAgIHRoZUlELCB7JHNldDoge3RlY2hub2xvZ3k6IHRlY2hWYWx1ZX19LFxuXHRcdFx0XHRcdFx0XHRcdFx0ICAgZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0QzRsb2cuaW5mbyggXCJVcGRhdGVUZWNoIEFzZXNzbWVudFwiKTtcblx0XHRcdFx0XHRcdFx0XHRcdH0pOyAqL1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQXBwTG9nLmVycm9yKFwiRXJyb3IgVXBkYXRpbmcgQXNzZXNzbWVudFwiLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZVRyYW5zaXRpb25zOiBmdW5jdGlvbiAoZG9tYWluOmFueSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9UcmFuc2l0aW9uQ2xhc3MuY3JlYXRlVHJhbnNpdGlvbnNTZXJ2ZXIoZG9tYWluKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdmFyIEZpYmVyID0gTnBtLnJlcXVpcmUoJ2ZpYmVycycpO1xuICAgICAgICBwcm9jZXNzLm9uKCd1bmNhdWdodEV4Y2VwdGlvbicsIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgIEFwcExvZy5lcnJvcihlcnIubWVzc2FnZSwgZXJyKTtcbiAgICAgICAgICAgIEZpYmVyKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyAgICAgIExvZ3MuaW5zZXJ0KHsgLi4uIH0pIC8vIExvZ3MgaXMgYSBjb2xsZWN0aW9uXG4gICAgICAgICAgICB9KS5ydW4oKTtcbiAgICAgICAgICAgIHByb2Nlc3MuZXhpdCgxKVxuICAgICAgICB9KTtcblxuICAgIH1cbn0pO1xuIl19